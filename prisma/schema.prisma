generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Vehicle {
  id            Int            @id @default(autoincrement())
  vin           String         @unique @db.VarChar(17)
  stockNumber   String?        @map("stock_number") @db.VarChar(50)
  year          Int
  make          String         @db.VarChar(100)
  model         String         @db.VarChar(100)
  trim          String?        @db.VarChar(100)
  price         Decimal?       @db.Decimal(10, 2)
  msrp          Decimal?       @db.Decimal(10, 2)
  mileage       Int?
  exteriorColor String?        @map("exterior_color") @db.VarChar(100)
  interiorColor String?        @map("interior_color") @db.VarChar(100)
  transmission  String?        @db.VarChar(50)
  fuelType      String?        @map("fuel_type") @db.VarChar(50)
  bodyStyle     String?        @map("body_style") @db.VarChar(50)
  drivetrain    String?        @db.VarChar(50)
  engine        String?        @db.VarChar(100)
  shortDescription String?      @map("short_description") @db.VarChar(500)
  longDescription  String?      @map("long_description") @db.Text
  features      Json?          @default("[]")
  isFeatured    Boolean        @default(false) @map("is_featured")
  isSold        Boolean        @default(false) @map("is_sold")
  sourceUrl     String?        @map("source_url") @db.VarChar(500)
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @updatedAt @map("updated_at")
  images        VehicleImage[]
  inquiries     ContactSubmission[]

  @@map("vehicles")
}

model VehicleImage {
  id        Int      @id @default(autoincrement())
  vehicleId Int      @map("vehicle_id")
  url       String   @db.VarChar(500)
  position  Int      @default(0)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at")
  vehicle   Vehicle  @relation(fields: [vehicleId], references: [id], onDelete: Cascade)

  @@map("vehicle_images")
}

model ScrapeLog {
  id              Int       @id @default(autoincrement())
  startedAt       DateTime  @map("started_at")
  completedAt     DateTime? @map("completed_at")
  vehiclesFound   Int?      @map("vehicles_found")
  vehiclesAdded   Int?      @map("vehicles_added")
  vehiclesUpdated Int?      @map("vehicles_updated")
  vehiclesRemoved Int?      @map("vehicles_removed")
  status          String    @db.VarChar(50)
  errorMessage    String?   @map("error_message") @db.Text
  createdAt       DateTime  @default(now()) @map("created_at")

  @@map("scrape_logs")
}

model ContactSubmission {
  id        Int      @id @default(autoincrement())
  name      String   @db.VarChar(100)
  email     String   @db.VarChar(255)
  phone     String?  @db.VarChar(20)
  message   String   @db.Text
  type      String   @default("general") @db.VarChar(50) // general, vehicle_inquiry, financing, consignment, sell_your_car
  vehicleId Int?     @map("vehicle_id")
  vehicle   Vehicle? @relation(fields: [vehicleId], references: [id], onDelete: SetNull)
  isRead    Boolean  @default(false) @map("is_read")
  createdAt DateTime @default(now()) @map("created_at")

  @@map("contact_submissions")
}
